var bannerContainer=document.querySelector(".info-banner-container"),bannerSearch=document.querySelector(".info-banner-search"),bannerSearchIcon=document.getElementById("banner-search"),bannerSearchInput=document.getElementById("banner-search-input");bannerSearch.addEventListener("click",function(){bannerContainer.classList.add("searching"),bannerSearchInput.focus()}),bannerSearchInput.addEventListener("blur",function(){bannerContainer.classList.remove("searching")});function getCookie(cname){for(var name=cname+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];c.charAt(0)==" ";)c=c.substring(1);if(c.indexOf(name)==0)return c.substring(name.length,c.length)}return""}function updateBanner(){fetch("/latestState").then(function(res){return res.json()}).then(function(data){var epochHandle=document.getElementById("banner-epoch-data");data.currentEpoch&&(epochHandle.textContent=data.currentEpoch);var ethPriceHandle=document.getElementById("banner-eth-price-data");let userCurrency=getCookie("currency");if(userCurrency)switch(userCurrency){case"AUD":if(data.audRoundPrice&&data.audTruncPrice)return ethPriceHandle.innerHTML="<span class='currency-symbol'>A$ </span><span class='k-formatted-price'>"+data.audTruncPrice+"</span><span class='price'>"+data.audRoundPrice+"</span>";break;case"CAD":if(data.cadRoundPrice&&data.cadTruncPrice)return ethPriceHandle.innerHTML="<span class='currency-symbol'>C$ </span><span class='k-formatted-price'>"+data.cadTruncPrice+"</span><span class='price'>"+data.cadRoundPrice+"</span>";break;case"CNY":if(data.cnyRoundPrice&&data.cnyTruncPrice)return ethPriceHandle.innerHTML="<span class='currency-symbol'>\xA5 </span><span class='k-formatted-price'>"+data.cnyTruncPrice+"</span><span class='price'>"+data.cnyRoundPrice+"</span>";break;case"EUR":if(data.eurRoundPrice&&data.eurTruncPrice)return ethPriceHandle.innerHTML="<span class='currency-symbol'>\u20AC </span><span class='k-formatted-price'>"+data.eurTruncPrice+"</span><span class='price'>"+data.eurRoundPrice+"</span>";break;case"GBP":if(data.gbpRoundPrice&&data.gbpTruncPrice)return ethPriceHandle.innerHTML="<span class='currency-symbol'>\xA3 </span><span class='k-formatted-price'>"+data.gbpTruncPrice+"</span><span class='price'>"+data.gbpRoundPrice+"</span>";break;case"JPY":if(data.jpyRoundPrice&&data.jpyTruncPrice)return ethPriceHandle.innerHTML="<span class='currency-symbol'>\xA5 </span><span class='k-formatted-price'>"+data.jpyTruncPrice+"</span><span class='price'>"+data.jpyRoundPrice+"</span>";break;case"RUB":if(data.rubRoundPrice&&data.rubTruncPrice)return ethPriceHandle.innerHTML="<span class='currency-symbol'>\u20BD </span><span class='k-formatted-price'>"+data.rubTruncPrice+"</span><span class='price'>"+data.rubRoundPrice+"</span>";break;default:if(data.usdRoundPrice&&data.usdTruncPrice)return ethPriceHandle.innerHTML="<span class='currency-symbol'>$ </span><span class='k-formatted-price'>"+data.usdTruncPrice+"</span><span class='price'>"+data.usdRoundPrice+"</span>"}var slotHandle=document.getElementById("banner-slot-data");data.currentSlot&&(slotHandle.textContent=data.currentSlot);var finDelayDataHandle=document.getElementById("banner-fin-data");if(finDelayHtml=`
      <div id="banner-fin" class="info-item d-flex mr-3">
      <div class="info-item-header mr-1 text-warning">
        <span class="item-icon">
          <i class="fas fa-exclamation-triangle" data-toggle="tooltip" title="" data-original-title="The last finalized epoch was ${data.finalityDelay} epochs ago."></i>
        </span>
        <span class="item-text">
          Finality
        </span>
      </div>
      <div class="info-item-body text-warning">
        <span id="banner-fin-data">${data.finalityDelay}</span>
        <i class="fas fa-exclamation-triangle item-text" data-toggle="tooltip" title="" data-original-title="The last finalized epoch was ${data.finalityDelay} epochs ago."></i>
      </div>
    </div>
    `,!finDelayDataHandle&&data.finalityDelay>3&&!data.syncing)document.getElementById("banner-slot").insertAdjacentHTML("afterend",finDelayHtml),$("#banner-fin i").each(function(){$(this).tooltip("update")});else if(finDelayDataHandle&&data.finalityDelay>3&&!data.syncing){finDelayDataHandle.textContent=data.finalityDelay;var icons=document.querySelectorAll("#banner-fin i");for(let i=0;i<icons.length;i++){const icon=icons[i];icon.setAttribute("data-original-title",`The last finalized epoch was ${data.finalityDelay} epochs ago.`)}$("#banner-fin i").each(function(){$(this).tooltip("update")})}else{var findDelayHandle=document.getElementById("banner-fin");findDelayHandle&&findDelayHandle.remove()}if(data.syncing){var findDelayHandle=document.getElementById("banner-fin");findDelayHandle&&findDelayHandle.remove();var bannerHandle=document.getElementById("banner-status");if(!bannerHandle){var statusHtml=`
            <div id="banner-status" class="info-item d-flex mr-3">
              <div class="info-item-body">
                <i class="fas fa-sync" data-toggle="tooltip" title="" data-original-title="The explorer is currently syncing with the network"></i>
              </div>
            </div>
            `;document.getElementById("banner-stats").insertAdjacentHTML("beforeend",statusHtml)}}else{var statusHandle=document.getElementById("banner-status");statusHandle&&statusHandle.remove()}})}setInterval(updateBanner,12e3);
